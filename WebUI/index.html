<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="page_title">天眼记录监控面板 | TitanEye</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <div id="loading-text" class="loading-text" data-i18n="loading">加载中...</div>
    </div>

    <div id="toast-container"></div>

    <div id="login-view" class="view-container">
        <div class="card login-box">
            <div class="login-title" data-i18n="login_title">👁️ 天眼后台系统</div>

            <div class="input-group">
                <label class="input-label" data-i18n="backend_address">后端地址</label>
                <input type="text" id="api-url" placeholder="http://127.0.0.1:8098" value="http://127.0.0.1:8098">
            </div>

            <div class="input-group">
                <label class="input-label" data-i18n="secret_key">Secret 密钥</label>
                <input type="password" id="api-secret" placeholder="" data-placeholder-i18n="enter_secret">
            </div>

            <div class="input-group">
                <label class="input-label" data-i18n="language">语言</label>
                <select id="language-select-login">
                    <option value="en_US">English</option>
                    <option value="zh_CN">中文</option>
                    <option value="ru_RU">Русский</option>
                </select>
            </div>

            <button class="btn btn-primary btn-block" id="btn-login" data-i18n="enter_console">进入控制台</button>
        </div>
    </div>

    <div id="main-view" class="view-container" style="display: none;">
        <header>
            <div class="brand">
                <span style="font-size: 24px;">👁️</span> <span data-i18n="console_title">Tianyan Console</span>
            </div>
            <div class="header-actions">
                <div class="language-selector">
                    <select id="language-select-main">
                        <option value="en_US">English</option>
                        <option value="zh_CN">中文</option>
                    </select>
                </div>
                <button class="btn btn-outline" id="btn-db-info" data-i18n="db_info">📊 数据库详情</button>
                <button class="btn btn-danger-outline" id="btn-logout" data-i18n="logout">退出登录</button>
            </div>
        </header>

        <div class="dashboard-container">
            <div class="stats-row">
                <div class="card stat-card">
                    <div class="stat-label" data-i18n="total_logs">总日志条数</div>
                    <div class="stat-value" id="stat-total">--</div>
                </div>
                <div class="card stat-card">
                    <div class="stat-label" data-i18n="db_size">数据库大小</div>
                    <div class="stat-value" id="stat-size">--</div>
                </div>
                <div class="card stat-card">
                    <div class="stat-label" data-i18n="query_time">查询耗时</div>
                    <div class="stat-value" id="stat-time">-- ms</div>
                </div>
                <div class="card stat-card flex-center">
                    <button class="btn btn-primary" id="btn-refresh-stats" data-i18n="refresh_stats">🔄 刷新状态</button>
                </div>
            </div>

            <div class="card">
                <div class="filter-section">
                    <div class="filter-row">
                        <div class="filter-item">
                            <label class="input-label" data-i18n="start_time">开始时间</label>
                            <input type="datetime-local" id="filter-start" class="datetime-input">
                        </div>
                        <div class="filter-item">
                            <label class="input-label" data-i18n="end_time">结束时间</label>
                            <input type="datetime-local" id="filter-end" class="datetime-input">
                        </div>

                        <div class="filter-item">
                            <label class="input-label" data-i18n="filter_field">查询字段</label>
                            <select id="filter-type">
                                <option value="" data-i18n="all_fields">全部字段 (不筛选)</option>
                                <option value="name" data-i18n="actor_name">行为实施者名 (Name)</option>
                                <option value="id" data-i18n="actor_id">行为实施者ID (ID)</option>
                                <option value="type" data-i18n="action_type">行为类型 (Type)</option>
                                <option value="obj_name" data-i18n="target_name">行为对象名 (Obj Name)</option>
                                <option value="obj_id" data-i18n="target_id">行为对象ID (Obj ID)</option>
                            </select>
                        </div>

                        <div class="filter-item" style="flex: 2;">
                            <label class="input-label" data-i18n="keyword">关键词</label>
                            <input type="text" id="filter-value" placeholder="" data-placeholder-i18n="enter_keyword">
                        </div>
                    </div>

                    <div class="coord-group">
                        <div class="coord-title" data-i18n="coord_query">📍 空间范围查询 (可选)</div>
                        <input type="number" class="coord-input" id="coord-x" placeholder="X">
                        <input type="number" class="coord-input" id="coord-y" placeholder="Y">
                        <input type="number" class="coord-input" id="coord-z" placeholder="Z">
                        <div class="coord-radius-group">
                            <span data-i18n="radius">半径:</span>
                            <input type="number" class="coord-input" id="coord-r" placeholder="R" value="10">
                        </div>
                        <select id="coord-dim" class="dim-select">
                            <option value="all" data-i18n="all_dimensions">所有维度</option>
                            <option value="Overworld" data-i18n="overworld">主世界</option>
                            <option value="Nether" data-i18n="nether">下界</option>
                            <option value="TheEnd" data-i18n="the_end">末地</option>
                            <option value="custom" data-i18n="custom">自定义...</option>
                        </select>
                        <input type="text" id="coord-dim-custom" placeholder="" data-placeholder-i18n="enter_dimension" style="display: none; width: 120px;">
                    </div>

                    <div class="filter-row action-buttons">
                        <button class="btn btn-outline" id="btn-reset" data-i18n="reset">重置</button>
                        <button class="btn btn-outline" id="btn-export" data-i18n="export_csv">📥 导出CSV</button>
                        <button class="btn btn-primary" id="btn-search" data-i18n="search_logs">🔍 查询日志</button>
                    </div>
                </div>
            </div>

            <div class="table-container">
                <table id="logs-table">
                    <thead>
                        <tr>
                            <th width="160" data-i18n="time">时间</th>
                            <th width="140" data-i18n="actor">实施者 (ID/Name)</th>
                            <th width="100" data-i18n="action_type">行为类型</th>
                            <th width="140" data-i18n="target">对象 (ID/Name)</th>
                            <th width="280" data-i18n="location">位置 (X, Y, Z, Dim)</th>
                            <th width="80" id="th-dist" style="display: none;" data-i18n="distance">距离</th>
                            <th data-i18n="details">详细数据</th>
                        </tr>
                    </thead>
                    <tbody id="logs-body">
                    </tbody>
                </table>
                <div id="empty-state" class="empty-state" style="display: none;">
                    <div class="empty-icon">📭</div>
                    <div data-i18n="no_data">暂无数据，请尝试调整搜索条件</div>
                </div>
            </div>

            <div class="card pagination">
                <div class="page-info" id="page-info"></div>
                <div class="page-controls">
                    <select id="page-size" data-i18n="page_size">
                        <option value="50" data-i18n="per_page_50">50/页</option>
                        <option value="100" selected data-i18n="per_page_100">100/页</option>
                        <option value="200" data-i18n="per_page_200">200/页</option>
                    </select>
                    <button class="btn btn-outline" id="btn-prev" data-i18n="prev_page">上一页</button>
                    <span id="page-curr" class="page-current">1</span>
                    <span class="page-divider">/</span>
                    <span id="page-total" class="page-total">1</span>
                    <button class="btn btn-outline" id="btn-next" data-i18n="next_page">下一页</button>
                    <div class="jump-page-group">
                        <input type="number" id="jump-page-input" min="1" placeholder="" data-placeholder-i18n="jump_page_placeholder">
                        <button class="btn btn-outline" id="btn-jump-page" data-i18n="jump_page">跳转</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>
</html>